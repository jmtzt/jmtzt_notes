<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Working with fastai2 - Low-Level API | Notes</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Working with fastai2 - Low-Level API" />
<meta name="author" content="João Marcelo Tozato" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This notebook contains some experiments made with fastai’s low level api with the MNIST dataset" />
<meta property="og:description" content="This notebook contains some experiments made with fastai’s low level api with the MNIST dataset" />
<link rel="canonical" href="https://jmtzt.github.io/jmtzt_notes/fastai/api/2021/08/08/fastai-Low-Level-API.html" />
<meta property="og:url" content="https://jmtzt.github.io/jmtzt_notes/fastai/api/2021/08/08/fastai-Low-Level-API.html" />
<meta property="og:site_name" content="Notes" />
<meta property="og:image" content="https://jmtzt.github.io/jmtzt_notes/images/low_level_api.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-08T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"This notebook contains some experiments made with fastai’s low level api with the MNIST dataset","url":"https://jmtzt.github.io/jmtzt_notes/fastai/api/2021/08/08/fastai-Low-Level-API.html","@type":"BlogPosting","headline":"Working with fastai2 - Low-Level API","dateModified":"2021-08-08T00:00:00-05:00","datePublished":"2021-08-08T00:00:00-05:00","author":{"@type":"Person","name":"João Marcelo Tozato"},"image":"https://jmtzt.github.io/jmtzt_notes/images/low_level_api.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://jmtzt.github.io/jmtzt_notes/fastai/api/2021/08/08/fastai-Low-Level-API.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/jmtzt_notes/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://jmtzt.github.io/jmtzt_notes/feed.xml" title="Notes" /><link rel="shortcut icon" type="image/x-icon" href="/jmtzt_notes/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/jmtzt_notes/">Notes</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/jmtzt_notes/about/">About Me</a><a class="page-link" href="/jmtzt_notes/search/">Search</a><a class="page-link" href="/jmtzt_notes/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Working with fastai2 - Low-Level API</h1><p class="page-description">This notebook contains some experiments made with fastai's low level api with the MNIST dataset</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-08-08T00:00:00-05:00" itemprop="datePublished">
        Aug 8, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">João Marcelo Tozato</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/jmtzt_notes/categories/#fastai">fastai</a>
        &nbsp;
      
        <a class="category-tags-link" href="/jmtzt_notes/categories/#api">api</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/jmtzt/jmtzt_notes/tree/master/_notebooks/2021-08-08-fastai-Low-Level-API.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/jmtzt_notes/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/jmtzt/jmtzt_notes/master?filepath=_notebooks%2F2021-08-08-fastai-Low-Level-API.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/jmtzt_notes/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/jmtzt/jmtzt_notes/blob/master/_notebooks/2021-08-08-fastai-Low-Level-API.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/jmtzt_notes/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#Imports">Imports </a></li>
<li class="toc-entry toc-h3"><a href="#Working-with-the-data">Working with the data </a></li>
<li class="toc-entry toc-h3"><a href="#Model-definition">Model definition </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Batch-Normalization">Batch Normalization </a></li>
<li class="toc-entry toc-h4"><a href="#Activation-functions">Activation functions </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#Simplifying-our-model">Simplifying our model </a></li>
<li class="toc-entry toc-h3"><a href="#ResNet-(kind-of)">ResNet (kind of) </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-08-08-fastai-Low-Level-API.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Imports">
<a class="anchor" href="#Imports" aria-hidden="true"><span class="octicon octicon-link"></span></a>Imports<a class="anchor-link" href="#Imports"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are the imports for everything we'll be using in this notebook</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>

<span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.callback.hook</span> <span class="kn">import</span> <span class="n">summary</span>
<span class="kn">from</span> <span class="nn">fastai.callback.schedule</span> <span class="kn">import</span> <span class="n">fit_one_cycle</span><span class="p">,</span> <span class="n">lr_find</span> 
<span class="kn">from</span> <span class="nn">fastai.callback.progress</span> <span class="kn">import</span> <span class="n">ProgressCallback</span>

<span class="kn">from</span> <span class="nn">fastai.data.core</span> <span class="kn">import</span> <span class="n">Datasets</span><span class="p">,</span> <span class="n">DataLoaders</span><span class="p">,</span> <span class="n">show_at</span>
<span class="kn">from</span> <span class="nn">fastai.data.external</span> <span class="kn">import</span> <span class="n">untar_data</span><span class="p">,</span> <span class="n">URLs</span>
<span class="kn">from</span> <span class="nn">fastai.data.transforms</span> <span class="kn">import</span> <span class="n">Categorize</span><span class="p">,</span> <span class="n">GrandparentSplitter</span><span class="p">,</span> <span class="n">parent_label</span><span class="p">,</span> <span class="n">ToTensor</span><span class="p">,</span> <span class="n">IntToFloatTensor</span><span class="p">,</span> <span class="n">Normalize</span>

<span class="kn">from</span> <span class="nn">fastai.layers</span> <span class="kn">import</span> <span class="n">Flatten</span>
<span class="kn">from</span> <span class="nn">fastai.learner</span> <span class="kn">import</span> <span class="n">Learner</span>

<span class="kn">from</span> <span class="nn">fastai.metrics</span> <span class="kn">import</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">CrossEntropyLossFlat</span>

<span class="kn">from</span> <span class="nn">fastai.vision.augment</span> <span class="kn">import</span> <span class="n">CropPad</span><span class="p">,</span> <span class="n">RandomCrop</span><span class="p">,</span> <span class="n">PadMode</span>
<span class="kn">from</span> <span class="nn">fastai.vision.core</span> <span class="kn">import</span> <span class="n">PILImageBW</span>
<span class="kn">from</span> <span class="nn">fastai.vision.utils</span> <span class="kn">import</span> <span class="n">get_image_files</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'dark_background'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<hr>
<p>This article is also a Jupyter Notebook available to be run from the top down. There
will be code snippets that you can then run in any environment.</p>
<p>Below are the versions of <code>fastai</code>, <code>fastcore</code>, and <code>wwf</code> currently running at the time of writing this:</p>
<ul>
<li>
<code>fastai</code> : 2.2.5 </li>
<li>
<code>fastcore</code> : 1.3.12 </li>
<li>
<code>wwf</code> : 0.0.16 </li>
</ul>
<hr>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>grabbing our data</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Working-with-the-data">
<a class="anchor" href="#Working-with-the-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Working with the data<a class="anchor-link" href="#Working-with-the-data"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path('/home/jmtzt/.fastai/data/mnist_png/testing/9/2934.png')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">PILImageBW</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">im</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Split our data with <code>GrandparentSplitter</code>, which will make use of a <code>train</code> and <code>valid</code> folder.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">(</span><span class="n">train_name</span><span class="o">=</span><span class="s1">'training'</span><span class="p">,</span> <span class="n">valid_name</span><span class="o">=</span><span class="s1">'testing'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">splits</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">5</span><span class="p">],</span> <span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([10000, 10001, 10002, 10003, 10004], [0, 1, 2, 3, 4])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<p>Make a <code>Datasets</code></p>
</li>
<li>
<p>Expects items, transforms for describing our problem, and a splitting method</p>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsrc</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[[</span><span class="n">PILImageBW</span><span class="o">.</span><span class="n">create</span><span class="p">],</span> <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">]],</span>
                  <span class="n">splits</span> <span class="o">=</span> <span class="n">splits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_at</span><span class="p">(</span><span class="n">dsrc</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:title={'center':'9'}&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we need to give ourselves some transforms on the data! These will need to:</p>
<ol>
<li>Ensure our images are all the same size</li>
<li>Make sure our output are the <code>tensor</code> our models are wanting</li>
<li>Give some image augmentation</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">CropPad</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">34</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="n">PadMode</span><span class="o">.</span><span class="n">Zeros</span><span class="p">),</span> <span class="n">RandomCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>ToTensor</code>: Converts to tensor</li>
<li>
<code>CropPad</code> and <code>RandomCrop</code>: Resizing transforms</li>
<li>Applied on the <code>CPU</code> via <code>after_item</code>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gpu_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">IntToFloatTensor</span><span class="p">(),</span> <span class="n">Normalize</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>IntToFloatTensor</code>: Converts to a float</li>
<li>
<code>Normalize</code>: Normalizes data</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dsrc</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">after_item</span><span class="o">=</span><span class="n">tfms</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">gpu_tfms</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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7WNPAAAgIQUAABJSAAAgIQUAABJyEiDwrlavXh2yrbfeuvjZnjrwB9l4AgAACSkAAJCQAgAACSkAAJCQAgAACfkpAOBdlY79PfTQQ7thJUBH8QQAABJSAAAgIQUAABJSAAAgIUOAQLscccQR3b0EoAGeAABAQgoAACSkAABAQgoAACTUUlVVa1u/2Nra5i/Bu2ppaenuJdjDNKQZ9nBV2cc0pq197AkAACSkAABAQgoAACSkAABAQu84BAgA9E6eAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACS0+Tv9Ymtra1etg3dw8cUXh+yiiy4K2X333ReyPfbYo1PWVEdLS0u33fv/sYdpRDPs4aqyj2lMW/vYEwAASEgBAICEFAAASEgBAICE3nEIkK53//33h+z6668PWbMMJwHQM3kCAAAJKQAAkJACAAAJKQAAkJAhwC6wYcOGkF199dXFz06dOjVkI0aMCNlpp50Wsj//8z9vx+oAyMgTAABISAEAgIQUAABISAEAgIQ6bQjwX//1X4v5Pvvs01m3bFo333xzyM4555za1x9xxBEha2uIEADq8AQAABJSAAAgIQUAABJSAAAgIQUAABLqtJ8C+MAHPtBZX93UVq9eHbJrr722oe/8zGc+09D1APB2ngAAQEIKAAAkpAAAQEIKAAAk1FJVVWtbv9ja2uYvUVXVypUrQzZu3LiQLV68uPZ3Lly4MGS77bbbpi2sSbS0tHT3EuxhGtIMe7iq7GMa09Y+9gQAABJSAAAgIQUAABJSAAAgoU47CbC3KQ387b333iF7+umnQ1YawNhrr72K9+mpA38A9CyeAABAQgoAACSkAABAQgoAACTkJMCaPvShD4WsNPBXst9++4XsBz/4QfGzgwcP3rSFNbFmOEWtN+3hV199tZjPmTOn0+990EEHhWz06NGdft/u1gx7uKp6xj4u7c/S33OnnHJKh9/77/7u70J20UUXdfh9eionAQIAGykAAJCQAgAACSkAAJBQ+iHAVatWhaw0UDJr1qyQlQYrSgN/3//+90M2ZMiQukvssZphgKqn7uGf/vSnITv//POLn33iiSc6eznVqFGjQlZ3CLYna4Y9XFXdu4/feuutkD3zzDMhO/nkk0N27733dsqa3u6P//iPQ/azn/0sZLvssktXLKfpGAIEADZSAAAgIQUAABJSAAAgofRDgFOmTAnZ7NmzQ1b6vZgwYULIfvKTn4SsN53utymaYYCqJ+zh008/PWTXXXdd7evrDpQOHDgwZFtssUXInn322ZAZAuxeXbWPSwN/3/3ud0N24okndsVyaiv9/hx44IEhu/3220PWp0+fzlhSUzEECABspAAAQEIKAAAkpAAAQEJphgC/9a1vFfNJkybVur408HfhhReGbOLEiZu0rt6sGQaomm0Pf+973wvZ8ccfH7LSMFZbw6Tz588P2Qc+8IGQ9e/fP2R33313yI499tiQDRgwIGS33XZbcT2f+tSninlP1Ax7uKq6bh8vXrw4ZN352uf3v//9ITv77LND9uCDD4bs1ltvDdmXv/zlkM2YMaOdq+s5DAECABspAACQkAIAAAkpAACQkAIAAAn1yp8CeOSRR0I2bty44mffeOONWt/5u9/9LmSlyeiS0ruzly9fXvzsXXfdFbJbbrml1n2+8pWvhKzuTzl0hmaYoO7OPbx69eqQfehDHwrZihUrQnbIIYeEbM6cOcX7DB8+fNMX99+eeuqpkH34wx8OWemnEkpHGFdVVV1zzTXtXk+zaYY9XFU5fgrgmGOOCdmf/dmfheyCCy4I2bx580J2xBFHhGzLLbcM2aJFi4rraeTPVbPxUwAAwEYKAAAkpAAAQEIKAAAktHl3L6BRr732WsjOOeeckNUd9quqqvr6178estLA37p160L20EMPheyoo44KWWnwq6rKwz51B5H+5m/+JmSlobPx48fX+j4aUzrit/S/+2abxR5+2WWXhazRoaQrr7wyZKW9Xhr4GzlyZMguv/zyhtZD8+nbt2/ISoNzpb93635faS9VVVXdeOONIevXr1+t+wwZMiRkpaOvS+suHc9dVeW/T3sbTwAAICEFAAASUgAAICEFAAAS6vFDgAcccEDIHnjggdrX77jjjiE7+eSTQ7ZmzZqQnXbaaSFra6Dk7YYNG1bMS+98Lw0bvvzyyyErDTouXbq01npoTGl4c+XKlbWuLQ15LliwoFbWln/4h38I2WOPPRayuifMlQb+SgNe9GzbbrttyO64446Q7bXXXiH72Mc+FrILL7wwZAcffHA7V9e2v/zLvwzZRz/60ZAtXLiww+/dk3kCAAAJKQAAkJACAAAJKQAAkFCPfx1wnz59QrYpr/D893//95DtscceHXqfv/3bvw3ZGWecUfzsNttsE7L7778/ZKUhnJK5c+eG7DOf+UytaxvVDK9S7ao9/Oijj4asNITUE3zhC18I2U033dT1C2kCzbCHq6r5/i4uDRyXTrTsqkHR+fPnh6z0Su0NGzaErK3Xur/00kshK52K2BN4HTAAsJECAAAJKQAAkJACAAAJ9fiTAEuvLi0No7T16tLS6VVHHnlkrfuUhrxKp7UNHTq0eO+S0kmCpYHB0lDQBz/4wZB11cBfdqNGjQrZBRdcELLp06e3+x5jx44t5p/97GdDduaZZ7b7Pocddli7ryWH0qt2O8Mf/vCHkJVeqf3UU0+FrDTwV/L6668X82YbvOwMngAAQEIKAAAkpAAAQEIKAAAk1OOHAEsDf6VTj+68887i9Q899FDIfvzjH9e6z7hx40L24osvhuwXv/hFyE4//fTiepYsWRKy0j/PiBEjQnb77bcXv5POVzoh7NOf/nTIHn744VrfV3rN9XHHHVf8bOkUwpLSUFPp9a8HHXRQre+DjvTcc8+FbMaMGSErveq6tLeb5RTHZuYJAAAkpAAAQEIKAAAkpAAAQELpXwdcV+n3ojSIVzpVas2aNR1+nzvuuCNkzfb62WYYwukJe7iu0itYq6o8tHf33XfX+s5LLrkkZOedd96mLawXa4Y9XFW9ax9feeWVxfzss89u93fWPRF2U/zbv/1byCZMmNDQd3YXrwMGADZSAAAgIQUAABJSAAAgIQUAABLq8T8FcPHFF4esdFTkyy+/3NB9Gjlqcuuttw7Z4MGDi5/99re/HbLSTwGU3j/fbJphgron7OG67rvvvmI+fvz4kJV+70888cSQXX311SEbNGhQO1bXOzXDHq6qnruPp02bFrIbbrih+Nlly5a1+z6dcRTw0KFDQ/bAAw+EbIcddmjoPl3BTwEAABspAACQkAIAAAkpAACQUI8fAixZuXJlyNo6GvW6664LWWnYqvR7UToWcvLkySH7xCc+EbJhw4YV19ObNMMAVU/dw4888kjIxo0bV/zsunXran3nkiVLQjZy5MhNWVY6zbCHq6r59vH9998fsltvvTVkP/nJT0L2/PPPd/h6OmMIsGTSpEkhK/07pHREfXcyBAgAbKQAAEBCCgAAJKQAAEBCvXIIkObQDANUPXUPX3rppSH76le/Wvv62bNnh+ykk05qaE0ZNcMerqru3celgb+99tqrG1bStrpDgAMHDgzZpz71qeJ3/uhHP6p175tuuilkn/vc52pd21UMAQIAGykAAJCQAgAACSkAAJDQ5t29AKAxpQGo0mmWhgB5N88991zIDjjggG5YSeeYO3duyD75yU8WP1s69a902uHUqVNDVnpF93bbbVdniV3KEwAASEgBAICEFAAASEgBAICEDAFCN/vd734XsuXLl9e+fvTo0SHbfvvtG1oTOa1fvz5kpf3ZbIYMGRKy0nDfxIkTQ9a/f//id86aNStkJ554Ysj233//kM2cOTNkV155ZfE+3ckTAABISAEAgIQUAABISAEAgIQMAUI3++53vxuya665pvb1pdPNxowZ09CaoCe59957Q7bTTjs19J2DBg0K2bhx40JWeh3wr3/964bu3VU8AQCAhBQAAEhIAQCAhBQAAEiopaqq+C7R/1Z6zSjU1dLS0t1LaLo9vGrVqpDtscceIVu8eHHIhg4dWvzOX/3qVyEbOXJkO1bH2zXDHq6qrtvHK1asCNnee+8dskWLFnXFcqrdd989ZAsWLAhZW6f5dZc//OEPIdt88+6buW9rH3sCAAAJKQAAkJACAAAJKQAAkJACAAAJOQoYulBpgrk08b/FFluE7Bvf+EbxO03801GGDx8esvnz54ds1KhRHX7v0sT/Rz/60ZA128R/SXdO/G8KTwAAICEFAAASUgAAICEFAAASchQwnaYZjlFttj182223hezpp58O2RlnnBGyAQMGdMqaaFsz7OGq6t59vGHDhpBNnjw5ZDfffHPILrzwwpCNGTOmeJ8DDjggZH369KmzRN6Fo4ABgI0UAABISAEAgIQUAABIyBAgnaYZBqjsYRrRDHu4quxjGmMIEADYSAEAgIQUAABISAEAgITecQgQAOidPAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABIaPN3+sXW1tauWge9UEtLS3cvwR6mIc2wh6vKPqYxbe1jTwAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAASUgAAICEFAAAS2ry7FwAAJRs2bAjZI488ErKbb745ZIcffnjI9t133w5ZV2/hCQAAJKQAAEBCCgAAJKQAAEBChgCBHmft2rUhmzZtWvGzc+bMCdkHP/jBkN1yyy2NLou3ef3110P2+OOPFz/7ox/9KGS//vWvQ3b77bfXuvehhx5a63OZeQIAAAkpAACQkAIAAAkpAACQUEtVVa1t/WJra5u/BO+qpaWlu5dgDzeJFStWhGz9+vUhmzdvXsgWLlwYstIg2MCBA4v3Xr58eY0VVtXHP/7xkN133321ru1sPWEfr169OmTTp08P2RVXXFH7O0eMGBGyL33pSyEbP358yMaOHRuyvn371r53b9LW38WeAABAQgoAACSkAABAQgoAACTU44cA161bF7Jf/vKXIdt7772L15eGI4477riQnXnmmSHbdddd6ywxLUOAvdsbb7xRzD//+c+H7I477ghZaQjwzTffrHXvyy+/PGRHHnlk8bPHHHNMrXvfdNNNIdtpp51qraezNds+XrZsWch23HHHkJVOAiz9/VpVVTVu3LiQ/fVf/3XIBg0aVGeJ/A+GAAGAjRQAAEhIAQCAhBQAAEioRw0BvvrqqyE744wzQjZ37tyQtfXPUhqO2GqrrUJWGk6aOXNmyD796U+HbIsttijeu7czBNh7LFiwIGSlP3tVVVVPPPFEyDp6L5T+PD7wwAPFz06YMCFkpbVfddVVIWuGPVxVzbePZ8+eHbJTTjklZGeffXbIZsyY0Slrom2GAAGAjRQAAEhIAQCAhBQAAEhIAQCAhDbv7gW0pfRe8EsvvTRkDz74YEP3+exnPxuyKVOmhKz0vulJkyaF7M477wzZ9ddfH7L3vOc9dZcIXeq1114LWelI1ldeeaV4felI3ttuuy1kQ4cODVnp2N4VK1aEbO3atSF76qmniuspOfbYY2t/lqitn7h4O7/Pzc0TAABISAEAgIQUAABISAEAgISa4ijgRx55JGSHHXZYyF54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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xb</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">yb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([128, 1, 28, 28]), torch.Size([128]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So our input shape will be a [128 x 1 x 28 x 28] and our output shape will be a [128] tensor that we need to condense into 10 classes</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model-definition">
<a class="anchor" href="#Model-definition" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model definition<a class="anchor-link" href="#Model-definition"> </a>
</h3>
<ul>
<li>This model will have 5 convolutional layers</li>
<li>We'll use <code>nn.Sequential</code>
</li>
<li>1 -&gt; 32 -&gt; 10</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">conv</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">):</span> <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we can see our <code>ni</code> is equivalent to the depth of the filter, and <code>nf</code> is equivalent to how many filters we will be using. (Fun fact this always has to be divisible by the size of our image).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Batch-Normalization">
<a class="anchor" href="#Batch-Normalization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Batch Normalization<a class="anchor-link" href="#Batch-Normalization"> </a>
</h4>
<p>As we send our tensors through our model, it is important to normalize our data throughout the network. Doing so can allow for a much larger improvement in training speed, along with allowing each layer to learn independantly (as each layer is then re-normalized according to it's outputs)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bn</span><span class="p">(</span><span class="n">nf</span><span class="p">):</span> <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>nf</code> will be the same as the filter output from our previous convolutional layer</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Activation-functions">
<a class="anchor" href="#Activation-functions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Activation functions<a class="anchor-link" href="#Activation-functions"> </a>
</h4>
<p>They give our models non-linearity and work with the <code>weights</code> we mentioned earlier along with a <code>bias</code> through a process called <strong>back-propagation</strong>. These allow our models to learn and perform more complex tasks because they can choose to fire or activate one of those neurons mentioned earlier. On a simple sense, let's look at the <code>ReLU</code> activation function. It operates by turning any negative values to zero, as visualized below:</p>
<p><img src="https://miro.medium.com/max/2052/1*DfMRHwxY1gyyDmrIAd-gjQ.png" alt=""></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ReLU</span><span class="p">():</span> <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential (Input shape: 128)
============================================================================
Layer (type)         Output Shape         Param #    Trainable 
============================================================================
                     128 x 8 x 14 x 14   
Conv2d                                    80         True      
BatchNorm2d                               16         True      
ReLU                                                           
____________________________________________________________________________
                     128 x 16 x 7 x 7    
Conv2d                                    1168       True      
BatchNorm2d                               32         True      
ReLU                                                           
____________________________________________________________________________
                     128 x 32 x 4 x 4    
Conv2d                                    4640       True      
BatchNorm2d                               64         True      
ReLU                                                           
____________________________________________________________________________
                     128 x 16 x 2 x 2    
Conv2d                                    4624       True      
BatchNorm2d                               32         True      
ReLU                                                           
____________________________________________________________________________
                     128 x 10 x 1 x 1    
Conv2d                                    1450       True      
BatchNorm2d                               20         True      
____________________________________________________________________________
                     []                  
Flatten                                                        
____________________________________________________________________________

Total params: 12,126
Total trainable params: 12,126
Total non-trainable params: 0

Optimizer used: &lt;function Adam at 0x7f56a8917790&gt;
Loss function: FlattenedLoss of CrossEntropyLoss()

Callbacks:
  - TrainEvalCallback
  - Recorder
  - ProgressCallback</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>learn.summary</code> also tells us:</p>
<ul>
<li>Total parameters</li>
<li>Trainable parameters</li>
<li>Optimizer</li>
<li>Loss function</li>
<li>Applied <code>Callbacks</code>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.33113112449646, lr_steep=0.7585775852203369)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAEKCAYAAAAfGVI8AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/d3fzzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAs7UlEQVR4nO3deVhU9f8F8DMwiOygiAgo4o77lISFhqml5K6V5b4hlbm1uaSpqUW5L2WKJJZmpaK5oqm4fhWHBJFF3FBBBQREBgQV+Pz+qPhlLIJwubOc1/O8n2TunZkzo81h7p25VwFAgIiIDJaR3AGIiEheLAIiIgPHIiAiMnAsAiIiA8ciICIycCwCIiIDp5Q7QEWlpqbixo0bcscgItIprq6ucHBwKHGZzhXBjRs34OHhIXcMIiKdolarS10m2aYhFxcXHDlyBDExMYiOjsakSZOKrWNtbY1du3YhMjIS0dHRGDVqlFRxiIioDEKKcXR0FCqVSgAQlpaWIj4+Xri7uz+xzowZM4S/v78AIOzt7UV6erowMTEp83bVarUkeTkcDkefp6zXTsneESQnJyMiIgIAkJ2djbi4ODg7Oz+xjhACVlZWAABLS0tkZGQgPz9fqkhERFSCatlH4OrqCpVKhbCwsCcuX716NXbt2oXbt2/DysoKgwcPhhCiOiIREdHfJP/4qIWFBbZv344pU6ZAo9E8saxHjx6IjIyEk5MT2rdvj9WrVxe9Q/g3X19fqNVqqNVq2NvbSx2ZiMjgSLZNSqlUipCQEDF16tQSl+/Zs0d06tSp6OfDhw8LDw+PZ97OxeFwOJySR5Z9BAAQGBiIuLg4LFu2rMTlN2/eRLdu3QAADg4OaN68Oa5duyZlJACAsVKJhu3awFipc5+eJSKqcpK9Enp5eWHEiBGIiooq2mk8c+ZMNGjQAACwdu1azJ8/H0FBQYiKioJCocC0adOQnp4uSR6FQoGG7dvguV490O61rrCws8XuJatxNGizJPenLZQ1aqAgPx+isFDuKESkpSQrglOnTkGhUJS5zp07d9CjRw+pIjzBo18vDJ7/GR7l5iE69DicmjXBc71eq9YiqNuoIbLS0pGbpXn6ys/Ipm4dvDJ6GJxaNIW9iwts6taBJj0D5w8ewbm9B5AYHQfrOvao7eIEE7OaiD8VxpIgMnAGs20k5ugJ/DxjHqKPHMfDBw/QacibGDDjQzi4uSI1QbpDVji4ueK5Xj3Qvmd31HGtj4cPHiAseDdObPoVGbfulHldl5bN0XXsCCgUCqQlJiHtZhKSYi/iVtylYusqTU3hPeJtdBs3EkbGRkiMjsOlM2eRnnQbjk0awXNAH3R65w0UFhbCyOj/twjevBCLX+d8ieTLV6v8sRORblDgr50FOkOtVlfJISasatfC54d34VDARhz4NqAKkj3J2qEOek99H8/37onCggJcUZ9D1B+hcG3bGs+9/hoURgpcOq3G1fAIJEScx624S3j88CFEYSFs6zrAZ/K76NDHBzn3MpF9LxO1XZygrFEDAJCZnIKYoyeRFBsPu3p1Ubu+Mxo93x529Rxx/uAR7Fm6uljJmFqYo023LqjjWh/37iQjPek2rO1ro8/HE2FubY3DgT8i9uhJ5GRmIifzPh7mPCj2mBQKBYxNTJD/6NGTlxsZoY5rfVjWsoOJqSlMatZEwePHyExJQWZyapnvgIyUxmjh9SI69PWBhZ0tbl+8jFsXL+F+Sips69VFLWcn2NWrC5OaNaGsYQJjpRK5WRpkpqTifkoqMm4lIz0xCelJt4vlIqL/V9Zrp8EWAQC8G7AKto4O8O8zuEpuDwBqmNVEpyFvovv4UTAyNsaxjVtw8uet0KRnFK1jU7cOOr3zBlp6d4Jjk0Yl3s7jhw9x/KdfcSTwR+Rl50BhZARbRwc08XgOrV55Gc1f8kQNs5ooLCxEZnIKUq/dQOiGTbhy9s8K5bWwtUHfTyejQx+fJy4veJyPB1lZyMm8D1FYCAs7W1jY2sBYqcT91Lu4eyMRmXdSULu+M5yaN4WpuVmp9/EoNw+5WRrkZmcjT5ONhzk5yMt5gILHj9HEswOs7WtDk56BjKTbcGza+InbKiwoQNbdNDx8kIv8R49QkJ8PC1sb2DjUKSpGACgsLETajUREhhzCn3sPIO1GYoWeByJ9xyIohefAPnhr3kwsGzwKSbHxAIAuI4egddeXkRh7EYnRsUhNuAnLWrawqesAcxtrnD94BBlJt4vdVsN2beDRvxfa9+yOmpYWiDp0FLuXrCpx3X+zsLVBw/ZtULexG4xNTGBkbIzCggKod+5FZnJKqddTmprCxqEOMpNTUPD4ceWeCACOTRujllM9WNhaw8LWFmY21rCwtYG5jTWMjI2RnXEP2ffuIf/hI9R2cUYd1/qwc66HjKTbSIqNR1JcPLJS7+JRXh4e5z2E0rQGbB3rwtbRATZ16qCmpQXMrK1gZm0FUzMzmFqYo4aZGZLi4qHeuRcXT51GYX5B0bsL6zr2uHc7GfeSk1GYX1Asr0KhgEUtW9jVqwf7Bi6wb+CCRs+3R5MXnoeRkRFuX7qCnHuZKMzPR0F+Ae7dSUZqwg2kJtzAnUtXnihmIkPAIiiFmbU15h7dg5Obt2L3klVo37M7hi+aj7SbSbCyr13ib7mP8x7ij3UbcDToZwhRCFXPV9Fl9FA4NWuChw8e4PzBIwjbvhvXI6OqJCNVjLVDHah6dkdzL0+YmJrCWKmEskYN1HKuBzPr//+y4r07ybh5IRaJ0bG4eSEWSbHxePig+OYwIn3BIijDmFWL4NyiKTZ+OBPv//AdEmPi8L3vJIjCQjg0agj7+i7QpKfjfspdKIwU6PPRRLR7rSvuXr8Jk5qmsHWsizuXr+LEpl8RGXKYLyZazLK2Heq6NYRTi2ZwbdMS9du0hH19FwB/bVrKSLqNwoICGJv89RmKyJDDOPLDT8jTZMsZm6hKsAjKoHr9NQz7eh7ycnKQc+8+VgwZi5x7mWVep0Wnjnh98nvIzdIgNGgzLp44XWV5qHpZ2Nqgfmt3NGjTCnUbu0EUFqIgPx/m1tZo6e2FnMz7OLQuCP/7NZg7o0mnsQjKUMPMDPOO7UNhYQFWDRuP5CvSf7OZdINzi2boNeU9NPfqiAdZWYg6GIpz+w7iWngED45IOodF8BQtOnVEdkYmkmIvVuntkn5o3EGFFwb2QZtu3jA1N4cmPQOXw8Jx+bQal06fRWZKqtwRiZ6KRUBUBUxqmqJVl85o1aUTmnb0gFXtWigsLETUwSP4Y10Qv5RHWq2s106D+WYxUWU9znuIyJBDiAw5BABwbNIIz/XqAa93BqF9z+64cPgYDq4JxO34yzInJaoYviMgqiQza2t0HvomOg97C+bW1ogMOYQD362X9NAlRBVV1mun5CemIdJ3uVlZOLgmEAt7DsIfazegRecX8cmOzeg9dQIURvxfjLQf/5USVZE8TTZCVq/Dlz5vICx4N14ZMwxjVn4DUwtzuaMRlYlFQFTFcu5lYtsXX2PbF9+guZcnJv60DrVcnOSORVQqFgGRRE5v3YF1flNg41AHkzYFoF6zJnJHIioRi4BIQlfO/omVw3xR8Pgx3t/wLVzbtZY7ElExLAIiid29fhOrR7yLnIxM+K1biaYd+ak30i4sAqJqcO9OMlaPehfpiUkY990SvDJ66FNP5UpUXVgERNUkO/0evh39PmJCT6D3hx9g/LoVsHaoI3csIhYBUXXK02Tjx48+w6+ffwnXtq3x8faf0HnoW1CamsodjQwYi4BIBmd37MaywaNwO/4y+k+fis/2b8PLw99mIZAsWAREMrl7/Sa+HzcR3456DylXr6Pfp5PxwcY1sK5jL3c0MjAsAiKZXfszEt/7TsQPkz6Fg5srJv+8nt85oGrFIiDSEjGhJ/DtyPcAhQIf/Pg9WnTqKHckMhAsAiItcuviJawYMg5pN5IwZuUitOneRe5IZAAkKwIXFxccOXIEMTExiI6OxqRJk0pcz9vbGxEREYiOjsbRo0elikOkM7JS72LN2Am4GR2L4YvmQ/X6a3JHIgMgpBhHR0ehUqkEAGFpaSni4+OFu7v7E+vY2NiImJgYUb9+fQFA1KlT56m3q1arJcnL4Wjb1DAzE+8FrhaLzp8SL/TvLXsejm5PWa+dkr0jSE5ORkREBAAgOzsbcXFxcHZ2fmKdIUOGIDg4GImJiQCAu3fvShWHSOc8ys3F+gkf4fLps3hz3gy07uotdyTSU9Wyj8DV1RUqlQphYWFPXN6sWTPY2dkhNDQU4eHhGD58eHXEIdIZj/MeYsOU6Ui8EIuh/nNRv3VLuSORnpL07YiFhYUIDw8XAwYMKLZs1apV4vTp08Lc3FzUrl1bXLp0STRt2rTYer6+vkKtVgu1Wi0SEhJkf4vF4VT3WNayEzP3bxNzj+4VtZzryZ6Ho3sjy6YhAFAqldi+fTs2b96MHTt2FFuelJSEAwcO4MGDB0hPT8fx48fRrl27YusFBATAw8MDHh4eSEtLkzIykVbKzriH9e9/BGOlEuO+Wwozayu5I5EekbQIAgMDERcXh2XLlpW4/Pfff0enTp1gbGwMMzMzeHp6Ii4uTspIRDorNeEGNkyZjtouThi13B/GJiZyRyI9IVkReHl5YcSIEejatSsiIiIQEREBHx8f+Pn5wc/PDwBw8eJFhISEICoqCmfPnsX69esRExMjVSQinXctPAK/zF6IJh7P4e35n8kdh/SI7NuuKjL8+CiHA9Ft3Eix5MJp4TPRT/YsHN2Ysl47lSAinXN4/UbYOTui+/hRSE+8hbM798gdiXQYDzFBpKOCFyzGpdNnMWj2J/xYKVUKi4BIRxUWFOCnT2bjfmoaRi3/Cpa17eSORDqKRUCkwx7cz8KGydNgbm2NEUsWwkhpLHck0kEsAiIdd+fSFfw250s0fl6Ffp9OkTsO6SDuLCbSAxH7/4Cze3O8Mnookq9cw+nfdsgdiXQI3xEQ6Ym9y79D7LFTGDDjQzT17CB3HNIhLAIiPSEKC7Fp2udITbiBEUsWwr6Bi9yRSEewCIj0yMOcB/hh4icoLCjA2NWLYWFrI3ck0gEsAiI9k3HrDjZMng67eo4Y991S1DAzkzsSaTkWAZEeuh4ZhR8/ngVn92YYtfwrGCv5uRAqHYuASE/FHjuJrXO/QvOXPPHOwtlQKBRyRyItxV8TiPSY+vd9sLCzQ5+PPsCDLA2CFy6WOxJpIRYBkZ47GrQZFrbW6Dp2BHI12di/8nu5I5GWYREQGYC9y9egppUVuvuORF52NkJ/2CR3JNIiLAIiAxG8cDFqWlqg99QJyE7PgPr3fXJHIi3BIiAyEKKwEFs++wKWtewwaPanSL6SgMQYnhqW+KkhIoNSmF+ATZ/MhiYt469DV9fioauJRUBkcHIy7yNoynRY2Npi+OIFPHQ1sQiIDNGti5ewdZ4/mng8x0NXE/cREBmqP/eEwKl5U3QZNQRZqWk4vH6j3JFIJiwCIgO2Z+lqWNnXwuuT30V2RgbCgnfLHYlkwCIgMmBCCPw6eyEsbG3xxufTkH0vEzGhJ+SORdWM+wiIDFxBfj42fjgTiTEXMezrL+DYpJHckaiasQiICI9yc7Fh8jTk5eRg5NIvYWpuLnckqkYsAiICAGjS0rHpk9mwb+CCt+bNkDsOVSMWAREVuRoegf2r1qJ9z+7weucNueNQNZGsCFxcXHDkyBHExMQgOjoakyZNKnXdDh064PHjxxg0aJBUcYionEJ/2ISYoyfR95NJcG3XWu44VA0kK4L8/Hx89NFHaNWqFTp27IgJEybA3d29eAAjI3z99dc4ePCgVFGIqAKEENjy2RfITE7ByCVfwqp2LbkjkcQkK4Lk5GREREQAALKzsxEXFwdnZ+di602cOBHbt29HamqqVFGIqIJyszQImjIdNa0sMXwJD0Oh76plH4GrqytUKhXCwsKeuNzJyQkDBgzAmjVryry+r68v1Go11Go17O3tpYxKRH+7c+kqfpvzJRo/r0KfjybKHYckJqQcCwsLER4eLgYMGFBs2W+//SY8PT0FALFhwwYxaNCgp96eWq2WNC+Hw3ly+nw8USy5cFp4DuwjexbOs89TXjulu2OlUilCQkLE1KlTS1x+7do1kZCQIBISEoRGoxEpKSmiX79+lXkwHA6nisfI2FiMW7NULIo8KVp16SR7Hs6zjWxFsHHjRrFs2bJyrct3BByO9k4Ns5pi0ub1wl99VLg91072PJyKT1mvnZLtI/Dy8sKIESPQtWtXREREICIiAj4+PvDz84Ofn59Ud0tEEniUm4fACR/h3p1kjF21CI5NG8sdiaqQAn81gs5Qq9Xw8PCQOwaRQbKr54iJP61DYWEBVrwzFpr0DLkjUTmV9drJbxYTUbndu5OMwIkfw8LWFqNW+ENZo4bckagKsAiIqEJuxV3CzzPnoWG7NjwmkZ5gERBRhV04dBT7Vn6P53v3RLdxI+WOQ5XEIiCiZ3I4YCPO7TuInh/4olEHldxxqBJYBET0zLbO9UfazSQM9Z8LcxtruePQM2IRENEze5Sbi02ffg5LO1u8PX+W3HHoGbEIiKhSbl28hD1Lv0WrVzqj0xCew0AXsQiIqNJObP4NMUdPos9HE9GY+wt0DouAiKrEls/mI+1mEsasWgTnFs3kjkMVwCIgoiqRm5WFtX5T8OB+Fny/XwZ71/pyR6JyYhEQUZXJSr2LtX6TAQB+a1fAyr62zImoPFgERFSl0m4kIuC9qbCws8Wwb76AkTHPbqbtWAREVOVuxV3C9gWL0MTjObz23li549BTsAiISBJ/7t6PsODd6OY7Es1e5BGDtRmLgIgks+OrJUi5moAhX82FdR2eb1xbsQiISDKP8x7ip49noYaZGYZ8NQcKI77kaCP+rRCRpFKuXceOr5agqWcHdB07XO44VAIWARFJTr1zLyL2HUSP98ehYbs2cseh/yhXEZibm0OhUAAAmjZtij59+kCpVEoajIj0y7b53yAzOQVDv56HmlaWcsehfylXERw/fhw1a9aEk5MTDh48iOHDhyMoKEjiaESkT/Kyc7Dp089h41AHg+fNlDsO/Uu5ikChUCA3NxcDBw7Ed999h7feegutWrWSOhsR6ZmbF2Kxd/l3aPvqK3j13TFyx6G/lbsIOnbsiKFDh2Lv3r0AAGN+W5CInsGxH7cgfNd+9Jzgizbdu8gdh1DOIpgyZQpmzJiBHTt2IDY2Fm5ubggNDZU6GxHpqa3z/HH9/AW8s/BzODVvKnccAiAqMgqFQlhZWVXoOlU5arVatvvmcDhVN1a1a4nZf+wUnx0IFmbW8r2mGMqU9dpZrncEmzdvhpWVFczNzREdHY3Y2Fh8/PHH5bkqEVGJNOkZCJoyAzZ16mDQZ3w9kVO5iqBly5bQaDTo378/9u/fDzc3Nwwfzi+GEFHlJMbE4cCa9VC9/hpUPq/KHcdglasITExMoFQq0b9/f+zatQv5+fkQQpR5HRcXFxw5cgQxMTGIjo7GpEmTiq0zZMgQnD9/HlFRUTh16hTatm37bI+CiHRW6A+bcD3yAgbO+hi2dR3kjmOwnrptaeLEiSIpKUns3btXABANGjQQx48fL/M6jo6OQqVSCQDC0tJSxMfHC3d39yfWefHFF4Wtra0AIHr27CnOnDlTqe1cHA5HN6e2i7P4MuyweDdglVAoFLLn0cd5ymvns92osbFxhdbfuXOn6N69e6nLbW1tRVJSUmUfDIfD0dHxHNhHLLlwWnT3Gy17Fn2cSu8stra2xpIlS6BWq6FWq7F48WJYWFiU56oAAFdXV6hUKoSFhZW6ztixY7F///4Sl/n6+hbdt709D2VLpI/CgncjfPd++HwwHq26dJI7jsF5apNs27ZNzJ07V7i5uQk3Nzfx+eefi+3bt5erhSwsLER4eLgYMGBAqet06dJFxMbGilq1alWq1Tgcjm6P0tRUTN4SKBaePiQc3Fxlz6NPU+lNQxEREeW6rNhfqlIpQkJCxNSpU0tdp02bNuLKlSuiadOmVfFgOByOjo9tXQcx9+heMX33r6KmlaXsefRlKr1pKDc3F15eXkU/v/TSS8jNzX3q9QIDAxEXF4dly5aVuLx+/foIDg7G8OHDcfny5fJEISI9l5mSio1TZ8DOuR4Gf/GZ3HEMxlObpG3btiIyMlIkJCSIhIQEce7cOdGmTZsyr+Pl5SWEEOL8+fMiIiJCRERECB8fH+Hn5yf8/PwEABEQECAyMjKKlpfnt32+I+BwDGNeGT1ULLlwWnTo+7rsWfRhquxTQ1ZWVkWHl5g8ebI2PhgOh6MnozAyEu8HfScWnj4k7JwcZc+j61PpTUP/0Gg00Gg0AIAPP/ywIlclIqoQUViILTO/AAC8s/Bznu9YQs/8zP5zxjIiIqncu52Mnf5L0biDCt4j3pE7jt565iJ42iEmiIiqgvr3fYj6IxQ+k/zg0rK53HH0UplFkJWVhfv37xebrKwsODk5VVdGIjJwv831R3Z6BoZ9Mx+m5uZyx9E7ZRaBtbU1bGxsio21tTVMTEyqKyMRGbjcrCxsmjYHtV2cMJCHrK5y3PtCRDoh4dx5/PH9D+jQ1wfP9+4pdxy9wiIgIp1xKGAjrv4ZgYGzPoaDm6vccfQGi4CIdEZhQQE2T5uDx3kPMXLpl6hhZiZ3JL3AIiAinXI/5S42T5sDBzdXvDV3utxx9AKLgIh0zuWwcOxftQ6q119DpyFvyB1H57EIiEgnhf7wE6JDj6Pvx5Ph0rKF3HF0GouAiHSSEAJbPpuP7Ix7GDz/MxgrlXJH0lksAiLSWXmabGyb/w2cmjVB13Ej5I6js1gERKTTYo+dxLl9B9F9/Cg4NmkkdxydxCIgIp23038Z8jTZeGveTB6l9BnwGSMinZdzLxM7vloK17at4D38bbnj6BwWARHphciQQ4g+cgw9PxiPOg0byB1Hp7AIiEhvbJu/CI8fPsTgLz7jJqIK4DNFRHpDk5aOHf5L4aZqi85D35I7js5gERCRXjm35wBijp7E65PehX0DF7nj6AQWARHpnW1ffI3Hjx7i7QWzuYmoHPgMEZHeybqbhp1fLYObqi26jOS5jp+GRUBEeunPPSGIOnQUPT8YD8emjeWOo9VYBESkt7Z98TVyNdkYsvBzHouoDCwCItJbOfcysXWeP5zdm+HV98bIHUdrsQiISK/FhJ6A+ve96DpmOJxbNJM7jlaSrAhcXFxw5MgRxMTEIDo6GpMmTSpxvRUrVuDy5cs4f/48VCqVVHGIyID9/s0K5GTex5tzp8PI2FjuOFpJSDGOjo5CpVIJAMLS0lLEx8cLd3f3J9bx8fER+/btEwCEp6enOHPmzFNvV61WS5KXw+Ho97Tr0U0suXBavDz8bdmzyDFlvXZK9o4gOTkZERERAIDs7GzExcXB2dn5iXX69euHH3/8EQAQFhYGW1tbODo6ShWJiAzY+QOHEXP0JHp+MB52Tnyd+bdq2Ufg6uoKlUqFsLCwJy53dnZGYmJi0c9JSUnFygIAfH19oVaroVarYW9vL3leItJPwQsWQYhCDJr9qdxRtIrkRWBhYYHt27djypQp0Gg0z3QbAQEB8PDwgIeHB9LS0qo4IREZisyUVOxfuRbunV5E+x7d5I6jNSQtAqVSie3bt2Pz5s3YsWNHseW3bt1C/fr1i352cXHBrVu3pIxERAbu1C/bkRgTh76fToaphbnccbSCpEUQGBiIuLg4LFu2rMTlu3btwogRf51n1NPTE/fv30dycrKUkYjIwInCQmyfvwhW9rXRY4Kv3HG0gmRftfPy8sKIESMQFRVVtNN45syZaNDgrxNGrF27Fvv27cPrr7+OK1eu4MGDBxg9erRUcYiIiiTGxOH0bzvQecibCP99H27HX5Y7kuxk/1hTRYYfH+VwOFUxZtZWYu7RvWLipnVCoVDInkfqkeXjo0RE2iw3S4Pdi1ehYbs28BzUV+44smIREJHB+nNPCK6oz6HXlPdhWctO7jiyYREQkUHbPv8b1DA3Q+8PJ8gdRTYsAiIyaKkJN3B0w2Z49OuFxh0M83hnLAIiMniHAoKQnnQLg2Z/apDnLWAREJHBe5z3EMFfLkHdRg3RZfRQueNUOxYBERGAiydOI/LAYbz27hg4Nmkkd5xqxSIgIvrbji+XIC87B28vmAUjpeGct4BFQET0t+yMe9i+cDHqt3LHK6OHyR2n2rAIiIj+JergEUTs/wOvvTcW9Zo1ljtOtWAREBH9x44vlyA3S4PB82dBYaT/L5P6/wiJiCooJ/M+dn61FPVbtoDnwD5yx5Eci4CIqASRBw7jangEfCb6wczaSu44kmIREBGVYqf/Mpjb2uDVd8fIHUVSLAIiolLcjr+MsO270OntN+Dg5ip3HMmwCIiIyrB/1Vo8ys1F/2lT5I4iGRYBEVEZcu5l4sCaQDT36oi2r3WVO44kWARERE9xass2JMZexIAZH+rljmMWARHRUxQWFGDrnK9gYWuDPh9NlDtOlWMREBGVw62Ll3Bs48/wHNgHTT07yB2nSrEIiIjK6cCaH3D3+k288fk0mNQ0lTtOlWEREBGVU/7Dh/htnj/sG7jAZ6Kf3HGqDIuAiKgCroVH4OSWbeg8bDAaPd9e7jhVgkVARFRBe5d9i4yk23h7wSzUMDOTO06lsQiIiCroUW4efpk1H3ZO9dDnow/kjlNpLAIiomeQEBGFYxu34KXBA9HsxRfkjlMpkhVBYGAgUlJScOHChRKXW1tbY9euXYiMjER0dDRGjRolVRQiIkmErF6HlGvXMWjWJzA2MZE7zjOTrAiCgoLQs2fPUpdPmDABsbGxaN++Pbp06YIlS5bARIefSCIyPPmPHuH3r5fDvoELOg99S+44z0yyIjhx4gQyMjJKXS6EgJXVX1/VtrS0REZGBvLz86WKQ0Qkifj/hSH22Cm86jcalrXt5I7zTGTbR7B69Wq4u7vj9u3buHDhAiZPngwhRInr+vr6Qq1WQ61Ww97evpqTEhGVbdfilTAxNYXPB7r53QLZiqBHjx6IjIyEk5MT2rdvj9WrVxe9Q/ivgIAAeHh4wMPDA2lpadWclIiobHev38TJLVvxwsA+cG7RTO44FSZbEYwePRrBwcEAgKtXryIhIQEtWrSQKw4RUaUc/P4HPMi8j37Tp8gdpcJkK4KbN2+iW7duAAAHBwc0b94c165dkysOEVGl5GmysW/l92j8vAoe/XvJHadClFLd8M8//4wuXbrA3t4eiYmJmDNnTtGngtauXYv58+cjKCgIUVFRUCgUmDZtGtLT06WKQ0QkubPBu+HR93X0+fADxB49iZzM+3JHKjehS6NWq2XPwOFwOKVN3cZu4ptzJ8TbC2bJnuXfU9ZrJ79ZTERUhVKuJiB0wyZ49OuFxh7PyR2nXFgERERV7I91QUhLTMKbn0+DqYW53HGeikVARFTF8h8+xG9zvkItZyeM+3YJapjVlDtSmVgEREQSuKo+h80z5qJh+zYYs3IRlKbae0YzFgERkUTOHziMLbPmo/ELz2HU8q+09sB0LAIiIgmd23MAW+f6w73Tixi1/Csoa9SQO1IxLAIiIomd3bEbW+f5o+XLXhi1wl/ryoBFQERUDc5s+x2/zfkS7p1exJiVX2vVPgMWARFRNQkL3o1fZy9E0xdfwLhvF8PUXDs+WsoiICKqRmd37sEvn81Ho+fb4931q2BuYy13JBYBEVF1+3NPCDZOnYF6zRpjQtAaWDvUkTUPi4CISAYxR08i4L0PYVuvLiZs+E7Ws5uxCIiIZHJVfQ7r/KbAyr42xq9ZjpqWFrLkYBEQEcnoxvlobPxwJhybNMLoFV/L8tFSFgERkcziT53Bllnz0eSF5zFi8YJq30zEIiAi0gIR+w4ieOFiuL/8Ej7bH4w+H02stkJgERARaYlTv2zH133fxvmDR/Dy8MGYuW87WnXpJPn9sgiIiLRI2s0k/DJrPr7u9w6Sr1zDiKVfwr3zS5LeJ4uAiEgLpd1IxLp3p+DOpSsYtfwrNH/JU7L7YhEQEWmpPE021o6fgpSr1zF6xddo2tFDkvthERARabHcrCx87zsRd2/chFOzJpLch1KSWyUioirz4H4WVgwZh/xHjyS5fb4jICLSAVKVAMAiICIyeCwCIiIDxyIgIjJwkhVBYGAgUlJScOHChVLX8fb2RkREBKKjo3H06FGpohARURkkK4KgoCD07Nmz1OU2Njb47rvv0LdvX7Ru3RpvvvmmVFGIiKgMkhXBiRMnkJGRUeryIUOGIDg4GImJiQCAu3fvShWFiIjKINs+gmbNmsHOzg6hoaEIDw/H8OHDS13X19cXarUaarUa9vb21ZiSiEj/yfaFMqVSieeffx7dunWDmZkZTp8+jTNnzuDy5cvF1g0ICEBAQAAAIDU1FWq1GsBfm5fu379f6p//e5mJiQnS0tIqlPPft1GeZf+9rLwZ//mvvb19hTJWV75/LuNzqF35dCGjtuerTMayLtO259DV1bXM+xdSjaurq7hw4UKJy6ZNmybmzp1b9PP69evFG2+8UaHbX7t2bZl//u9larW6wo/h37dRnmX/vay8Gf/5b0UzVlc+PofamU8XMmp7vspkLOsybXsOyxrZNg39/vvv6NSpE4yNjWFmZgZPT0/ExcVV6DZ2795d5p9LW/6s91GeZf+9rLwZtT2fLmQ0xHy6kFHb81Um49Muq6qMVfEcPk2FWqu88/PPP4vbt2+LR48eicTERDFmzBjh5+cn/Pz8itb5+OOPRUxMjLhw4YKYPHmyJDn+Pc/y22x1j7Zn1PZ8upBR2/PpQkZtz6crGf81sgeotvH19ZU9g65n1PZ8upBR2/PpQkZtz6crGf8Zxd9/ICIiA8VDTBARGTgWARGRgWMREBEZOBbB3zp16oQ1a9YgICAAp06dkjtOiRQKBRYsWICVK1dixIgRcscpxtvbG8ePH8eaNWvg7e0td5wSmZubQ61Wo1evXnJHKVGLFi2wZs0abN26Fe+++67ccUrUr18/rFu3Dr/88gteffVVueMU4+bmhvXr12Pr1q1yRylibm6OoKAgrFu3DkOGDJE7Tolk32Nd2QkMDBQpKSnFvrzWo0cPcfHiRXH58mUxbdq0ct1Wv379xPjx47UyY//+/UVQUJBYsmSJ6Nq1q9ble/nll8W+ffvEhg0bROPGjbUuHwAxb9488cknn4hevXpp5d/xP6NQKMRPP/2k1RltbW3F+vXrtTbf1q1bq/z5e9asw4YNE7179xYAxC+//CJprmcc2QNUejp37ixUKtUTfyFGRkbiypUrws3NTZiYmIjIyEjh7u4uWrduLXbv3v3E1KlTp+h6v/76q7C0tNTKjNOmTSsqqar+R14V+RQKhQAgHBwcxKZNm7QuX/fu3cXgwYPFyJEjJSmCqvp32KdPH7Fv3z7xzjvvaG1GAGLx4sVCpVJpbT6pi6AiWadPny7atWsnAIjNmzdLmusZR/YAVTL/PZxFx44dRUhISNHP06dPF9OnTy/zNurXry/WrVuntRmHDh0q3nzzTQFI81tFVTyHAISJiYkk/xNWNt+CBQvEsmXLxIEDB8TOnTuLikubMv579uzZo5X/DgEIf39/0a1bN63NB0hfBBXJOmzYsKJfPrZs2SJ5roqObAedk5qzs3PRIa4BICkpCZ6enmVeZ+zYsdiwYYPU0YpUNGNwcDBWrVqFzp074/jx41qXb8CAAejRowdsbW2xevVqrcs3a9YsAMDIkSORlpYGIYTWZfT29sbAgQNhamqKffv2SZ4PqHjGiRMnonv37rCxsUGTJk2wdu1arcpXq1YtLFy4ECqVCtOnT4e/v7+k+f6ttKwrV67E6tWr0atXr2c+BIWU9LYInsXcuXPljlCm3NxcjBs3Tu4YpdqxYwd27Nghd4yn2rhxo9wRSnXs2DEcO3ZM7hhlWrVqFVatWiV3jFJlZGTgvffekzvGEx48eIAxY8bIHaNUevupoVu3bqF+/fpFP7u4uODWrVsyJipO2zMyX+UxY+Vpe75/06Ws/yX79qmqmP9uqzM2NhZXr14VDRs2LNpp07JlS2ZkPmbU8ozank9Xsz5lZA9Q6SnpSKcAhI+Pj4iPjxdXrlwRM2fOZEbmY0Ytz6jt+XQ169OGB50jIjJweruPgIiIyodFQERk4FgEREQGjkVARGTgWARERAaORUBEZOBYBKQXNBpNtd5fVZ2zwtvbG5mZmYiIiEBcXBwWLVr01Ov069cP7u7uVXL/RACLgKhExsbGZS738vKqsvs6ceIEVCoVVCoVevfujZdeeqnM9fv374+WLVtW2f0TsQhIbzVq1Aj79+9HeHg4jh8/jubNmwMAevfujTNnzuDcuXP4448/4ODgAACYM2cOfvzxR5w8eRI//fQT5syZg8DAQISGhuLq1auYOHFi0W3/8w7E29sboaGh2Lp1K+Li4rBp06aidXx8fBAXF4fw8HCsWLHiqUedzMvLQ2RkJJydnQEA48aNw9mzZxEZGYlt27bBzMwML774Ivr27YtFixYhIiICjRo1KvVxElWE7F9v5nAqOxqNpthlhw4dEk2aNBEAxAsvvCAOHz4sgL/OrPXPOmPHjhWLFy8WAMScOXNEeHi4qFmzZtHPp06dEjVq1BC1a9cWaWlpQqlUPnF/3t7eIjMzUzg7OwuFQiH+97//CS8vL2Fqaipu3rwpGjZsKIC/Dkewe/fuYhm9vb2LLre1tRXh4eGibt26AoCoVatW0Xrz588XH3zwgQAgNmzYIAYNGvTUx8nhlHd4GGrSSxYWFnjppZeeOG+tqakpgL+OCPnrr7+iXr16qFGjBhISEorW2bVrF/Ly8op+3rt3Lx49eoT09HSkpqaibt26xY4mefbs2aLLIiMj0bBhQ2RnZ+PatWu4fv06AGDLli0YP358iVk7d+6MyMhING3aFMuXL0dKSgoAoHXr1liwYAFsbW1haWmJAwcOVOhxEpUXi4D0kpGRETIzM6FSqYotW7VqFZYuXYrdu3fD29v7ifNQ5OTkPLHuw4cPi/5cUFAApbL4/zLlWacsJ06cQJ8+fdCwYUOcOXMGv/32G86fP4+goCD0798fUVFRGDlyJLp06VKhx0lUXtxHQHpJo9EgISEBb7zxRtFlbdu2BQDY2NgU/QY/cuRISe4/Pj4ejRo1gqurKwBg8ODBT73O9evX4e/vj2nTpgEArKyscOfOHSiVSgwdOrRoPY1GAysrq6I/l/Y4icqLRUB6wdzcHImJiUUzdepUDB06FGPHjkVkZCRiYmLQr18/AH+diW7r1q0IDw9HWlqaJHny8vLw/vvvIyQkBOHh4dBoNLh///5Tr/f999/j5ZdfhqurK2bPno2wsDCcOnUKFy9eLFrnl19+wSeffIJz586hUaNGpT5OovLiYaiJJGJhYVG0qenbb7/F5cuXsXz5cnlDEZWA7wiIJOLr64uIiAjExMTAxsZG8pO8Ez0rviMgIjJwfEdARGTgWARERAaORUBEZOBYBEREBo5FQERk4FgEREQG7v8AZ64gata6PaAAAAAASUVORK5CYII=%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.210623</td>
      <td>0.194198</td>
      <td>0.939300</td>
      <td>00:09</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.139447</td>
      <td>0.079532</td>
      <td>0.975500</td>
      <td>00:09</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.068283</td>
      <td>0.037102</td>
      <td>0.987500</td>
      <td>00:09</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simplifying-our-model">
<a class="anchor" href="#Simplifying-our-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Simplifying our model<a class="anchor-link" href="#Simplifying-our-model"> </a>
</h3>
<ul>
<li>Try to make it more like <code>ResNet</code>.</li>
<li>
<code>ConvLayer</code> contains a <code>Conv2d</code>, <code>BatchNorm2d</code>, and an activation function</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">conv2</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">):</span> <span class="k">return</span> <span class="n">ConvLayer</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">net</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.202230</td>
      <td>0.219875</td>
      <td>0.931000</td>
      <td>00:09</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.130472</td>
      <td>0.079829</td>
      <td>0.972500</td>
      <td>00:09</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.076784</td>
      <td>0.038371</td>
      <td>0.986900</td>
      <td>00:09</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ResNet-(kind-of)">
<a class="anchor" href="#ResNet-(kind-of)" aria-hidden="true"><span class="octicon octicon-link"></span></a>ResNet (kind of)<a class="anchor-link" href="#ResNet-(kind-of)"> </a>
</h3>
<p>The ResNet architecture is built with what are known as ResBlocks. Each of these blocks consist of two <code>ConvLayers</code> that we made before, where the number of filters do not change. Let's generate these layers.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ResBlock</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nf</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">ConvLayer</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">ConvLayer</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Class notation</li>
<li><code>__init__</code></li>
<li><code>forward</code></li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">ResBlock</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ResBlock</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">ResBlock</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ResBlock</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Awesome! We're building a pretty substantial model here. Let's try to make it <strong>even simpler</strong>. We know we call a convolutional layer before each <code>ResBlock</code> and they all have the same filters, so let's make that layer!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">conv_and_res</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">):</span> <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">conv2</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">),</span> <span class="n">ResBlock</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">conv_and_res</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">conv_and_res</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv_and_res</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">conv_and_res</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now we have something that resembles a ResNet! Let's see how it performs</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">net</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.15848932266235352, lr_steep=0.2089296132326126)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.154220</td>
      <td>0.295265</td>
      <td>0.907000</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.087304</td>
      <td>0.072216</td>
      <td>0.976400</td>
      <td>00:10</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.041664</td>
      <td>0.023510</td>
      <td>0.992200</td>
      <td>00:10</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">'export.pkl'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/jmtzt_notes/fastai/api/2021/08/08/fastai-Low-Level-API.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/jmtzt_notes/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/jmtzt_notes/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/jmtzt_notes/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>These are my notes about deep learning &amp;&amp; stuff</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/jmtzt" title="jmtzt"><svg class="svg-icon grey"><use xlink:href="/jmtzt_notes/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
